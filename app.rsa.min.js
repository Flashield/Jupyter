!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.JSEncrypt={})}(this,function(a){"use strict";function c(a){return b.charAt(a)}function m(a,b){function c(){this.constructor=a}l(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function E(){return new C(null)}function F(a,b){return new C(a,b)}function I(a,b,c,d,e,f){for(var i,j,k,g=16383&b,h=b>>14;--f>=0;)i=16383&this[a],j=this[a++]>>14,k=h*i+j*g,i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i;return e}function N(a,b){var c=K[a.charCodeAt(b)];return null==c?-1:c}function O(a){var b=E();return b.fromInt(a),b}function P(a){var c,b=1;return 0!=(c=a>>>16)&&(a=c,b+=16),0!=(c=a>>8)&&(a=c,b+=8),0!=(c=a>>4)&&(a=c,b+=4),0!=(c=a>>2)&&(a=c,b+=2),0!=(c=a>>1)&&(a=c,b+=1),b}function R(){return new Q}function Y(){if(null==T){for(T=R();S>V;){var a=Math.floor(65536*Math.random());U[V++]=255&a}for(T.init(U),V=0;V<U.length;++V)U[V]=0;V=0}return T.next()}function $(a,b){var c,d,e,f,g;if(b<a.length+11)return console.error("Message too long for RSA"),null;for(c=[],d=a.length-1;d>=0&&b>0;)e=a.charCodeAt(d--),128>e?c[--b]=e:e>127&&2048>e?(c[--b]=128|63&e,c[--b]=192|e>>6):(c[--b]=128|63&e,c[--b]=128|63&e>>6,c[--b]=224|e>>12);for(c[--b]=0,f=new Z,g=[];b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);c[--b]=g[0]}return c[--b]=2,c[--b]=0,new C(c)}var o,x,C,D,J,K,L,M,Q,S,T,U,V,W,X,Z,_,bb,cb,db,eb,fb,b="0123456789abcdefghijklmnopqrstuvwxyz",l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},p={decode:function(a){var b,c,d,e,f,g,h;if(void 0===o){for(c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="= \f\n\r	 \u2028\u2029",o=Object.create(null),b=0;64>b;++b)o[c.charAt(b)]=b;for(b=0;b<d.length;++b)o[d.charAt(b)]=-1}for(e=[],f=0,g=0,b=0;b<a.length&&(h=a.charAt(b),"="!=h);++b)if(h=o[h],-1!=h){if(void 0===h)throw new Error("Illegal character at offset "+b);f|=h,++g>=4?(e[e.length]=f>>16,e[e.length]=255&f>>8,e[e.length]=255&f,f=0,g=0):f<<=6}switch(g){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:e[e.length]=f>>10;break;case 3:e[e.length]=f>>16,e[e.length]=255&f>>8}return e},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(a){var b=p.re.exec(a);if(b)if(b[1])a=b[1];else{if(!b[2])throw new Error("RegExp out of sync");a=b[2]}return p.decode(a)}},u=function(){function a(b,c){this.hexDigits="0123456789ABCDEF",b instanceof a?(this.enc=b.enc,this.pos=b.pos):(this.enc=b,this.pos=c)}return a.prototype.get=function(a){if(void 0===a&&(a=this.pos++),a>=this.enc.length)throw new Error("Requesting byte offset "+a+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(a):this.enc[a]},a.prototype.hexByte=function(a){return this.hexDigits.charAt(15&a>>4)+this.hexDigits.charAt(15&a)},a.prototype.hexDump=function(a,b,c){var e,d="";for(e=a;b>e;++e)if(d+=this.hexByte(this.get(e)),c!==!0)switch(15&e){case 7:d+="  ";break;case 15:d+="\n";break;default:d+=" "}return d},a}(),v=function(){function a(a,b,c,d,e){if(!(d instanceof w))throw new Error("Invalid tag value.");this.stream=a,this.header=b,this.length=c,this.tag=d,this.sub=e}return a.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},a.prototype.posStart=function(){return this.stream.pos},a.prototype.posContent=function(){return this.stream.pos+this.header},a.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},a.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},a.decodeLength=function(a){var d,b=a.get(),c=127&b;if(c==b)return c;if(c>6)throw new Error("Length over 48 bits not supported at position "+(a.pos-1));if(0===c)return null;for(b=0,d=0;c>d;++d)b=256*b+a.get();return b},a.prototype.getHexStringValue=function(){var a=this.toHexString(),b=2*this.header,c=2*this.length;return a.substr(b,c)},a.decode=function(b){var c,d,e,f,g,h,i,j,k;if(c=b instanceof u?b:new u(b,0),d=new u(c),e=new w(c),f=a.decodeLength(c),g=c.pos,h=g-d.pos,i=null,j=function(){var d,e,b=[];if(null!==f){for(d=g+f;c.pos<d;)b[b.length]=a.decode(c);if(c.pos!=d)throw new Error("Content size is not correct for container starting at offset "+g)}else try{for(;e=a.decode(c),!e.tag.isEOC();)b[b.length]=e;f=g-c.pos}catch(h){throw new Error("Exception while decoding undefined length content: "+h)}return b},e.tagConstructed)i=j();else if(e.isUniversal()&&(3==e.tagNumber||4==e.tagNumber))try{if(3==e.tagNumber&&0!=c.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");for(i=j(),k=0;k<i.length;++k)if(i[k].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(l){i=null}if(null===i){if(null===f)throw new Error("We can't skip over an invalid tag with undefined length at offset "+g);c.pos=g+Math.abs(f)}return new a(d,h,f,e,i)},a}(),w=function(){function a(a){var c,b=a.get();if(this.tagClass=b>>6,this.tagConstructed=0!==(32&b),this.tagNumber=31&b,31==this.tagNumber){c=new Int10;do b=a.get(),c.mulAdd(128,127&b);while(128&b);this.tagNumber=c.simplify()}}return a.prototype.isUniversal=function(){return 0===this.tagClass},a.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},a}(),A=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];for((1<<26)/A[A.length-1],C=function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}return a.prototype.toString=function(a){var b,d,e,f,g,h,i;if(this.s<0)return"-"+this.negate().toString(a);if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}if(d=(1<<b)-1,f=!1,g="",h=this.t,i=this.DB-h*this.DB%b,h-->0)for(i<this.DB&&(e=this[h]>>i)>0&&(f=!0,g=c(e));h>=0;)b>i?(e=(this[h]&(1<<i)-1)<<b-i,e|=this[--h]>>(i+=this.DB-b)):(e=this[h]>>(i-=b)&d,0>=i&&(i+=this.DB,--h)),e>0&&(f=!0),f&&(g+=c(e));return f?g:"0"},a.prototype.negate=function(){var b=E();return a.ZERO.subTo(this,b),b},a.prototype.abs=function(){return this.s<0?this.negate():this},a.prototype.compareTo=function(a){var c,b=this.s-a.s;if(0!=b)return b;if(c=this.t,b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0},a.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)},a.prototype.modPowInt=function(a,b){var c;return c=256>a||b.isEven()?new Classic(b):new D(b),this.exp(a,c)},a.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},a.prototype.fromInt=function(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0},a.prototype.fromString=function(b,c){var d,e,f,g,h;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return this.fromRadix(b,c),void 0;d=2}for(this.t=0,this.s=0,e=b.length,f=!1,g=0;--e>=0;)h=8==d?255&+b[e]:N(b,e),0>h?"-"==b.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB));8==d&&0!=(128&+b[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&a.ZERO.subTo(this,this)},a.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},a.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},a.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},a.prototype.lShiftTo=function(a,b){var h,c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),g=this.s<<c&this.DM;for(h=this.t-1;h>=0;--h)b[h+f+1]=this[h]>>d|g,g=(this[h]&e)<<c;for(h=f-1;h>=0;--h)b[h]=0;b[f]=g,b.t=this.t+f+1,b.s=this.s,b.clamp()},a.prototype.rShiftTo=function(a,b){var c,d,e,f,g;if(b.s=this.s,c=Math.floor(a/this.DB),c>=this.t)return b.t=0,void 0;for(d=a%this.DB,e=this.DB-d,f=(1<<d)-1,b[0]=this[c]>>d,g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()},a.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},a.prototype.multiplyTo=function(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)},a.prototype.squareTo=function(a){for(var d,b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c)d=b.am(c,b[c],a,2*c,0,1),(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1);a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},a.prototype.divRemTo=function(b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,e=b.abs();if(!(e.t<=0)){if(f=this.abs(),f.t<e.t)return null!=c&&c.fromInt(0),null!=d&&this.copyTo(d),void 0;if(null==d&&(d=E()),g=E(),h=this.s,i=b.s,j=this.DB-P(e[e.t-1]),j>0?(e.lShiftTo(j,g),f.lShiftTo(j,d)):(e.copyTo(g),f.copyTo(d)),k=g.t,l=g[k-1],0!=l){for(m=l*(1<<this.F1)+(k>1?g[k-2]>>this.F2:0),n=this.FV/m,o=(1<<this.F1)/m,p=1<<this.F2,q=d.t,r=q-k,s=null==c?E():c,g.dlShiftTo(r,s),d.compareTo(s)>=0&&(d[d.t++]=1,d.subTo(s,d)),a.ONE.dlShiftTo(k,s),s.subTo(g,g);g.t<k;)g[g.t++]=0;for(;--r>=0;)if(t=d[--q]==l?this.DM:Math.floor(d[q]*n+(d[q-1]+p)*o),(d[q]+=g.am(0,t,d,r,0,k))<t)for(g.dlShiftTo(r,s),d.subTo(s,d);d[q]<--t;)d.subTo(s,d);null!=c&&(d.drShiftTo(k,c),h!=i&&a.ZERO.subTo(c,c)),d.t=k,d.clamp(),j>0&&d.rShiftTo(j,d),0>h&&a.ZERO.subTo(d,d)}}},a.prototype.invDigit=function(){var a,b;return this.t<1?0:(a=this[0],0==(1&a)?0:(b=3&a,b=15&b*(2-(15&a)*b),b=255&b*(2-(255&a)*b),b=65535&b*(2-(65535&(65535&a)*b)),b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b))},a.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},a.prototype.exp=function(b,c){var d,e,f,g,h;if(b>4294967295||1>b)return a.ONE;for(d=E(),e=E(),f=c.convert(this),g=P(b)-1,f.copyTo(d);--g>=0;)c.sqrTo(d,e),(b&1<<g)>0?c.mulTo(e,f,d):(h=d,d=e,e=h);return c.revert(d)},a.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},a}(),D=function(){function a(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}return a.prototype.convert=function(a){var b=E();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(C.ZERO)>0&&this.m.subTo(b,b),b},a.prototype.revert=function(a){var b=E();return a.copyTo(b),this.reduce(b),b},a.prototype.reduce=function(a){for(var b,c,d;a.t<=this.mt2;)a[a.t++]=0;for(b=0;b<this.m.t;++b)for(c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++;a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}(),C.prototype.am=I,x=28,C.prototype.DB=x,C.prototype.DM=(1<<x)-1,C.prototype.DV=1<<x,J=52,C.prototype.FV=Math.pow(2,J),C.prototype.F1=J-x,C.prototype.F2=2*x-J,K=[],L="0".charCodeAt(0),M=0;9>=M;++M)K[L++]=M;for(L="a".charCodeAt(0),M=10;36>M;++M)K[L++]=M;for(L="A".charCodeAt(0),M=10;36>M;++M)K[L++]=M;if(C.ZERO=O(0),C.ONE=O(1),Q=function(){function a(){this.i=0,this.j=0,this.S=[]}return a.prototype.init=function(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(c=0,b=0;256>b;++b)c=255&c+this.S[b]+a[b%a.length],d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0},a.prototype.next=function(){var a;return this.i=255&this.i+1,this.j=255&this.j+this.S[this.i],a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[255&a+this.S[this.i]]},a}(),S=256,U=null,null==U&&(U=[],V=0,W=void 0,window.crypto&&window.crypto.getRandomValues))for(X=new Uint32Array(256),window.crypto.getRandomValues(X),W=0;W<X.length;++W)U[V++]=255&X[W];Z=function(){function a(){}return a.prototype.nextBytes=function(a){for(var b=0;b<a.length;++b)a[b]=Y()},a}(),_=function(){function a(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return a.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},a.prototype.setPublic=function(a,b){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=F(a,16),this.e=parseInt(b,16)):console.error("Invalid RSA public key")},a.prototype.encrypt=function(a){var c,d,b=$(a,this.n.bitLength()+7>>3);return null==b?null:(c=this.doPublic(b),null==c?null:(d=c.toString(16),0==d.length%2?d:"0"+d))},a.prototype.generate=function(a,b){var e,f,g,h,i,c=new Z,d=a>>1;for(this.e=parseInt(b,16),e=new C(b,16);;){for(;this.p=new C(a-d,1,c),0!=this.p.subtract(C.ONE).gcd(e).compareTo(C.ONE)||!this.p.isProbablePrime(10););for(;this.q=new C(d,1,c),0!=this.q.subtract(C.ONE).gcd(e).compareTo(C.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0&&(f=this.p,this.p=this.q,this.q=f),g=this.p.subtract(C.ONE),h=this.q.subtract(C.ONE),i=g.multiply(h),0==i.gcd(e).compareTo(C.ONE)){this.n=this.p.multiply(this.q),this.d=e.modInverse(i),this.dmp1=this.d.mod(g),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}},a}(),bb={},bb.lang={extend:function(a,b,c){var d,e,f;if(!b||!a)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");if(d=function(){},d.prototype=b.prototype,a.prototype=new d,a.prototype.constructor=a,a.superclass=b.prototype,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b),c){for(e in c)a.prototype[e]=c[e];f=function(){},f(a.prototype,c)}}},cb={},"undefined"!=typeof cb.asn1&&cb.asn1||(cb.asn1={}),cb.asn1.ASN1Util=new function(){},cb.asn1.ASN1Object=function(){},cb.asn1.DERAbstractString=function(){},bb.lang.extend(cb.asn1.DERAbstractString,cb.asn1.ASN1Object),cb.asn1.DERAbstractTime=function(){},bb.lang.extend(cb.asn1.DERAbstractTime,cb.asn1.ASN1Object),cb.asn1.DERAbstractStructured=function(){},bb.lang.extend(cb.asn1.DERAbstractStructured,cb.asn1.ASN1Object),cb.asn1.DERBoolean=function(){},bb.lang.extend(cb.asn1.DERBoolean,cb.asn1.ASN1Object),cb.asn1.DERInteger=function(){},bb.lang.extend(cb.asn1.DERInteger,cb.asn1.ASN1Object),cb.asn1.DERBitString=function(){},bb.lang.extend(cb.asn1.DERBitString,cb.asn1.ASN1Object),cb.asn1.DEROctetString=function(){},bb.lang.extend(cb.asn1.DEROctetString,cb.asn1.DERAbstractString),cb.asn1.DERNull=function(){},bb.lang.extend(cb.asn1.DERNull,cb.asn1.ASN1Object),cb.asn1.DERObjectIdentifier=function(){},bb.lang.extend(cb.asn1.DERObjectIdentifier,cb.asn1.ASN1Object),cb.asn1.DEREnumerated=function(){},bb.lang.extend(cb.asn1.DEREnumerated,cb.asn1.ASN1Object),cb.asn1.DERUTF8String=function(){},bb.lang.extend(cb.asn1.DERUTF8String,cb.asn1.DERAbstractString),cb.asn1.DERNumericString=function(){},bb.lang.extend(cb.asn1.DERNumericString,cb.asn1.DERAbstractString),cb.asn1.DERPrintableString=function(){},bb.lang.extend(cb.asn1.DERPrintableString,cb.asn1.DERAbstractString),cb.asn1.DERTeletexString=function(){},bb.lang.extend(cb.asn1.DERTeletexString,cb.asn1.DERAbstractString),cb.asn1.DERIA5String=function(){},bb.lang.extend(cb.asn1.DERIA5String,cb.asn1.DERAbstractString),cb.asn1.DERUTCTime=function(){},bb.lang.extend(cb.asn1.DERUTCTime,cb.asn1.DERAbstractTime),cb.asn1.DERGeneralizedTime=function(){},bb.lang.extend(cb.asn1.DERGeneralizedTime,cb.asn1.DERAbstractTime),cb.asn1.DERSequence=function(){},bb.lang.extend(cb.asn1.DERSequence,cb.asn1.DERAbstractStructured),cb.asn1.DERSet=function(){},bb.lang.extend(cb.asn1.DERSet,cb.asn1.DERAbstractStructured),cb.asn1.DERTaggedObject=function(){},bb.lang.extend(cb.asn1.DERTaggedObject,cb.asn1.ASN1Object),db=function(a){function b(c){var d=a.call(this)||this;return c&&("string"==typeof c?d.parseKey(c):(b.hasPrivateKeyProperty(c)||b.hasPublicKeyProperty(c))&&d.parsePropertiesFrom(c)),d}return m(b,a),b.prototype.parseKey=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;try{if(b=0,c=0,d=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,e=d.test(a)?Hex.decode(a):p.unarmor(a),f=v.decode(e),3===f.sub.length&&(f=f.sub[2].sub[0]),9===f.sub.length)b=f.sub[1].getHexStringValue(),this.n=F(b,16),c=f.sub[2].getHexStringValue(),this.e=parseInt(c,16),g=f.sub[3].getHexStringValue(),this.d=F(g,16),h=f.sub[4].getHexStringValue(),this.p=F(h,16),i=f.sub[5].getHexStringValue(),this.q=F(i,16),j=f.sub[6].getHexStringValue(),this.dmp1=F(j,16),k=f.sub[7].getHexStringValue(),this.dmq1=F(k,16),l=f.sub[8].getHexStringValue(),this.coeff=F(l,16);else{if(2!==f.sub.length)return!1;m=f.sub[1],n=m.sub[0],b=n.sub[0].getHexStringValue(),this.n=F(b,16),c=n.sub[1].getHexStringValue(),this.e=parseInt(c,16)}return!0}catch(o){return!1}},b.prototype.getPrivateBaseKey=function(){var a={array:[new cb.asn1.DERInteger({"int":0}),new cb.asn1.DERInteger({bigint:this.n}),new cb.asn1.DERInteger({"int":this.e}),new cb.asn1.DERInteger({bigint:this.d}),new cb.asn1.DERInteger({bigint:this.p}),new cb.asn1.DERInteger({bigint:this.q}),new cb.asn1.DERInteger({bigint:this.dmp1}),new cb.asn1.DERInteger({bigint:this.dmq1}),new cb.asn1.DERInteger({bigint:this.coeff})]},b=new cb.asn1.DERSequence(a);return b.getEncodedHex()},b.prototype.getPublicBaseKey=function(){var a=new cb.asn1.DERSequence({array:[new cb.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new cb.asn1.DERNull]}),b=new cb.asn1.DERSequence({array:[new cb.asn1.DERInteger({bigint:this.n}),new cb.asn1.DERInteger({"int":this.e})]}),c=new cb.asn1.DERBitString({hex:"00"+b.getEncodedHex()}),d=new cb.asn1.DERSequence({array:[a,c]});return d.getEncodedHex()},b.wordwrap=function(a,b){if(b=b||64,!a)return a;var c="(.{1,"+b+"})( +|$\n?)|(.{1,"+b+"})";return a.match(RegExp(c,"g")).join("\n")},b.prototype.getPublicKey=function(){var a="-----BEGIN PUBLIC KEY-----\n";return a+=b.wordwrap(this.getPublicBaseKeyB64())+"\n",a+="-----END PUBLIC KEY-----"},b.hasPublicKeyProperty=function(a){return a=a||{},a.hasOwnProperty("n")&&a.hasOwnProperty("e")},b.prototype.parsePropertiesFrom=function(a){this.n=a.n,this.e=a.e,a.hasOwnProperty("d")&&(this.d=a.d,this.p=a.p,this.q=a.q,this.dmp1=a.dmp1,this.dmq1=a.dmq1,this.coeff=a.coeff)},b}(_),eb=function(){function a(a){a=a||{},this.default_key_size=parseInt(a.default_key_size,10)||1024,this.default_public_exponent=a.default_public_exponent||"010001",this.log=a.log||!1,this.key=null}return a.prototype.setKey=function(a){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new db(a)},a.prototype.setPublicKey=function(a){this.setKey(a)},a.prototype.getKey=function(a){if(!this.key){if(this.key=new db,a&&"[object Function]"==={}.toString.call(a))return this.key.generateAsync(this.default_key_size,this.default_public_exponent,a),void 0;this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},a.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},a.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},a.prototype.encode=function(a){var e,f,g,h,i,b=this.getKey();(b.n.bitLength()+7>>3)-11;try{if(e="",a.length>32){for(f=parseInt(a.length/32)+1,h=0;f>h;)g=h==f-1?a.substring(32*h,a.length):a.substring(32*h,32*h+32),console.log(g),i=b.encrypt(g),console.log("分段1："+i.length),i.length<256&&(i=b.encrypt(g)),console.log("分段2："+i.length),e+=i,h++;return e}return b.encrypt(a)}catch(j){return""}},a.version="3.0.0-beta.1",a}(),window.JSEncrypt=eb,a.JSEncrypt=eb,a.default=eb,fb=function(){this.encodeObj=new eb,this.encodeObj.setPublicKey("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDGOJ8XSE9vjpoRMY8ekbTNbK5ISKDRvnFA/6JLoqAFA2EhcoSMx5R/X1jsRs1O1TxD5FspCS1Qh3swNB4A3cJwLcmwlsGmcK+GID30lXbkm1insPJD/vfe2C9hUsdaXlrhwAG8hhH2CEKS0lzc11JWlKn9OQ4s9u8tITTVtZhO/wIDAQAB"),this.encode=function(a){return this.encodeObj.encode(a)}},window.ztEncrptyUtil=new fb,Object.defineProperty(a,"__esModule",{value:!0})});